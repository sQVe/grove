# Test: grove list shows gone indicator when upstream branch is deleted
setup_workspace develop

exec grove add develop
# Create a bare remote to track against
cd $WORK
mkdir remote-repo
exec git init --bare remote-repo
cd workspace/develop
exec git remote add upstream file://$WORK/remote-repo
exec git push -u upstream develop

# Delete the upstream branch
exec git -C $WORK/remote-repo branch -D develop
exec git fetch upstream --prune
exec grove list --plain
stdout 'gone'
stderr 'Gathering worktree status'
