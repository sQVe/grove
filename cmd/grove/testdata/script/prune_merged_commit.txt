# Test: grove prune --merged --commit removes merged worktree but keeps branch
setup_workspace feature-merged

# Create commit and merge into main on remote
exec git -C $WORK/testrepo checkout feature-merged
cp $WORK/merged-feature.txt $WORK/testrepo/merged-feature.txt
exec git -C $WORK/testrepo add merged-feature.txt
exec git -C $WORK/testrepo commit -m 'feature commit'
exec git -C $WORK/testrepo checkout main
exec git -C $WORK/testrepo merge --no-ff feature-merged -m 'merge feature'
exec git -C $WORK/workspace/.bare fetch origin
exec git pull
exec grove add feature-merged
exec grove prune --merged --commit
stderr 'Pruned 1 worktree'
stderr 'feature-merged'
# Should NOT delete branch for --merged (only for gone)
! stderr 'deleted.*local branch'
! exists ../feature-merged
# Branch should still exist
exec git -C $WORK/workspace/.bare rev-parse --verify feature-merged

-- merged-feature.txt --
feature content
