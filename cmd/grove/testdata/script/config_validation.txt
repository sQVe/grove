# Test config command help
exec grove config --help
stdout 'Usage:'
stdout 'list'
stdout 'get'
stdout 'set'
stdout 'unset'

# Test config command execution shows help
exec grove config
stdout 'Usage:'

# Test config rejects invalid subcommands
! exec grove config invalid
stderr 'unknown command'

# Test argument validation - list
! exec grove config list extra
stderr 'unknown command'

# Test argument validation - get
! exec grove config get
stderr 'accepts 1 arg'

# Test argument validation - set
! exec grove config set --global key
stderr 'accepts 2 arg'

# Test argument validation - unset
! exec grove config unset --global
stderr 'accepts between 1 and 2 arg'

# Test set requires --shared or --global
! exec grove config set grove.plain true
stderr 'must specify --shared or --global'

# Test non-grove.* keys rejected - get
! exec grove config get --global user.name
stderr 'only grove\.\* settings'

# Test non-grove.* keys rejected - set
! exec grove config set --global user.name value
stderr 'only grove\.\* settings'

# Test non-grove.* keys rejected - unset
! exec grove config unset --global user.name
stderr 'only grove\.\* settings'

# Test boolean validation for grove.plain
! exec grove config set --global grove.plain maybe
stderr 'invalid boolean'

# Test boolean validation for grove.debug
! exec grove config set --global grove.debug 2
stderr 'invalid boolean'

# Test global operations work
exec grove config set --global grove.plain true
exec grove config get --global grove.plain
stdout '^true$'

exec grove config list --global
stdout 'grove.plain=true'

# Clean up global config
exec grove config unset --global grove.plain
