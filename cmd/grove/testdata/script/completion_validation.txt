# grove completion validation tests
# Tests shell completion script generation

## Help output

# No shell argument shows help
exec grove completion
stdout 'Generate the autocompletion script'
stdout 'Available Commands:'
stdout 'bash'
stdout 'zsh'
! stderr .

# --help shows help
exec grove completion --help
stdout 'Generate the autocompletion script'
! stderr .

## Shell script generation

# bash
exec grove completion bash
stdout '__start_grove'
stdout 'complete -o default -F'
! stderr .

# zsh
exec grove completion zsh
stdout '#compdef grove'
! stderr .

# fish
exec grove completion fish
stdout 'complete -c grove'
! stderr .

# powershell
exec grove completion powershell
stdout 'Register-ArgumentCompleter'
! stderr .

# invalid shell shows help
exec grove completion invalid
stdout 'Available Commands:'
! stderr .

## Output differentiation

# Bash uses __start_grove function name
exec grove completion bash
stdout '__start_grove'
! stdout '#compdef'
! stdout 'function grove'
! stderr .

# Zsh uses #compdef directive
exec grove completion zsh
stdout '#compdef grove'
! stdout '__start_grove'
! stderr .

# Fish uses 'complete -c grove'
exec grove completion fish
stdout 'complete -c grove'
! stdout '__start_grove'
! stdout '#compdef'
! stderr .
