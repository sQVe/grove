---
phase: 05-output-consistency
plan: 03
type: execute
wave: 2
depends_on: ['05-01', '05-02']
files_modified:
    - cmd/grove/commands/doctor.go
    - cmd/grove/commands/fetch.go
    - cmd/grove/commands/prune.go
autonomous: true

must_haves:
    truths:
        - 'Doctor success message uses logger.Success instead of fmt.Println'
        - 'Fetch empty state uses logger.Info instead of fmt.Println'
        - 'All user-facing output goes through logger package'
        - "Empty state messages follow 'No X found' or 'No X to Y' pattern"
    artifacts:
        - path: 'cmd/grove/commands/doctor.go'
          provides: 'logger.Success for no issues found'
          pattern: "logger\\.Success.*No issues found"
        - path: 'cmd/grove/commands/fetch.go'
          provides: 'logger.Info for all remotes up to date'
          pattern: "logger\\.Info.*All remotes up to date"
    key_links:
        - from: 'cmd/grove/commands/doctor.go'
          to: 'internal/logger/logger.go'
          via: 'logger.Success call'
          pattern: "logger\\.Success"
---

<objective>
Audit and fix remaining fmt.Print usage for user messages. Standardize empty state messages and ensure consistent verb tense.

Purpose: All user-facing output goes through logger package for consistent plain mode handling and styling. Empty states follow predictable patterns. This completes CLRT-02, CLRT-04, CLRT-05.

Output: Commands using logger consistently for user messages.
</objective>

<execution_context>
@/home/sqve/.claude/get-shit-done/workflows/execute-plan.md
@/home/sqve/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-output-consistency/05-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix doctor.go user message output</name>
  <files>cmd/grove/commands/doctor.go</files>
  <action>
Replace fmt.Println with logger calls for user messages in doctor.go.

1. **Line 576-579 - "No issues found" message:**

Change:

```go
if config.IsPlain() {
    fmt.Println("[ok] No issues found")
} else {
    fmt.Println("âœ“ No issues found")
}
```

To:

```go
logger.Success("No issues found")
```

The logger.Success already handles plain mode with appropriate symbols.

2. **Line 606-607 - Summary output:**

Change:

```go
fmt.Println()
fmt.Printf("Summary: %d errors, %d warnings (%d auto-fixable)\n", ...)
```

To:

```go
fmt.Println()  // Keep blank line for formatting
logger.Info("Summary: %d errors, %d warnings (%d auto-fixable)",
    result.Errors, result.Warnings, result.AutoFixable)
```

3. **Line 871 - Fix confirmation:**

Change:

```go
fmt.Printf("Fixed: %s (%s)\n", issue.Message, issue.Path)
```

To:

```go
logger.Success("Fixed: %s (%s)", issue.Message, issue.Path)
```

**Keep fmt.Print for structured output** (lines 668, 674-704, 1020-1045):

- Category headers and issue details are structured output (not user messages)
- Disk Usage analysis is data output
- These are acceptable to keep as fmt.Print

Note: Only convert messages that are user feedback (success, info, warnings). Keep fmt.Print for formatted data display (tables, structured reports).
</action>
<verify>
`grove doctor` with no issues shows "checkmark No issues found" (logger.Success style)
`grove doctor --plain` shows "[ok] No issues found" (plain mode)
`grove doctor --fix` shows "checkmark Fixed: ..." for each fixed issue
</verify>
<done>CLRT-04 partially satisfied: doctor.go user messages use logger</done>
</task>

<task type="auto">
  <name>Task 2: Fix fetch.go user message output</name>
  <files>cmd/grove/commands/fetch.go</files>
  <action>
Replace fmt.Println with logger calls for user messages in fetch.go.

1. **Line 82 - "No remotes configured":**

Change:

```go
fmt.Println("No remotes configured")
```

To:

```go
logger.Info("No remotes configured")
```

2. **Line 202 - "All remotes up to date":**

Change:

```go
fmt.Println("All remotes up to date")
```

To:

```go
logger.Success("All remotes up to date")
```

**Keep fmt.Print for data output** (lines 191, 221-238, 255-285):

- Remote change listings are data output (what changed)
- Verbose hash details are structured output
- These are acceptable as fmt.Print since they're piped data, not user feedback

This follows the pattern established in research: stderr for user messages, stdout for data output.
</action>
<verify>
`grove fetch` with no changes shows "checkmark All remotes up to date" (logger.Success)
`grove fetch` with no remotes shows "-> No remotes configured" (logger.Info)
`grove fetch --plain` uses appropriate plain symbols
</verify>
<done>CLRT-04 partially satisfied: fetch.go user messages use logger</done>
</task>

<task type="auto">
  <name>Task 3: Standardize empty state messages</name>
  <files>cmd/grove/commands/prune.go</files>
  <action>
Verify and standardize empty state messages across commands. The prune.go file has good patterns to verify:

1. **Line 224 in displayDryRun:**

```go
logger.Info("No worktrees to prune.")
```

This is correct "No X to Y" pattern.

2. **Line 284 in executePrune:**

```go
logger.Info("No worktrees to remove.")
```

This is correct.

3. **Line 271 in displayDryRun - blank line before hint:**
   Change:

```go
fmt.Println()
```

To use logger or keep as-is (blank lines for formatting are acceptable).

The empty state patterns are already consistent in prune.go. No changes needed unless deviations found.

Verify other commands follow the pattern:

- list.go: Returns empty table (acceptable - shows structure)
- status.go: Shows worktree info (no empty state for "current worktree")
- doctor.go: "No issues found" (correct pattern)
- fetch.go: "No remotes configured", "All remotes up to date" (correct patterns)

This task is primarily verification that patterns are consistent.
</action>
<verify>
All empty state messages follow "No X found", "No X to Y", or "All X up to date" patterns.
Messages use logger.Info or logger.Success (not fmt.Print).
</verify>
<done>CLRT-05 satisfied: Commands show consistent empty state messages</done>
</task>

</tasks>

<verification>
- `make test` passes
- `make lint` passes
- `grove doctor` (no issues) uses logger.Success
- `grove fetch` (no remotes) uses logger.Info
- `grove fetch` (up to date) uses logger.Success
- All empty state messages consistent
</verification>

<success_criteria>

- [ ] CLRT-02: Verified past-tense verbs (Created, Deleted, Updated) - already consistent
- [ ] CLRT-04: User messages use logger package (doctor, fetch fixed)
- [ ] CLRT-05: Empty state messages follow consistent patterns
- [ ] All tests pass
- [ ] No lint errors
      </success_criteria>

<output>
After completion, create `.planning/phases/05-output-consistency/05-03-SUMMARY.md`
</output>
