---
phase: 03-foundation
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
    - cmd/grove/commands/remove.go
    - cmd/grove/commands/remove_test.go
autonomous: true
gap_closure: true

must_haves:
    truths:
        - "Removing 1 worktree prints 'Removed worktree <name>'"
        - "Removing N worktrees prints 'Removed N worktrees' (no list)"
        - 'Failed removals still reported individually'
    artifacts:
        - path: 'cmd/grove/commands/remove.go'
          provides: 'Batch summary output for remove'
          contains: 'Removed %d worktrees'
    key_links:
        - from: 'cmd/grove/commands/remove.go'
          to: 'internal/logger'
          via: 'logger.Success for summary'
          pattern: "logger\\.Success.*Removed"
---

<objective>
Update remove command to use batch summary pattern instead of per-item success messages.

Purpose: Closes SPIN-04 gap - batch operations should conclude with summary count.
Output: Single summary message after batch removal.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03-foundation/03-VERIFICATION.md
@cmd/grove/commands/remove.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update remove.go to use batch summary</name>
  <files>cmd/grove/commands/remove.go</files>
  <action>
    Modify runRemove to accumulate removed worktrees and print summary at end:

    1. Track removed worktrees (not just failed):
       - Add `var removed []string` alongside existing `failed`

    2. On successful removal, append to removed instead of printing immediately:
       - Remove `logger.Success("Deleted worktree %s", info.Branch)`
       - Remove `logger.Success("Deleted worktree and branch %s", info.Branch)`
       - Append to removed slice instead

    3. After loop, print summary:
       ```go
       if len(removed) > 0 {
           if len(removed) == 1 {
               if deleteBranch {
                   logger.Success("Removed worktree and branch %s", removed[0])
               } else {
                   logger.Success("Removed worktree %s", removed[0])
               }
           } else {
               if deleteBranch {
                   logger.Success("Removed %d worktrees and branches", len(removed))
               } else {
                   logger.Success("Removed %d worktrees", len(removed))
               }
           }
       }
       ```

    Note: Use "Removed" (past tense) to match CLRT-02 requirement.

  </action>
  <verify>
    ```bash
    make test
    make lint
    ```
  </verify>
  <done>
    Single worktree removal shows "Removed worktree X".
    Multi worktree removal shows "Removed N worktrees".
    Branch deletion variant shows "Removed worktree and branch X" or "Removed N worktrees and branches".
  </done>
</task>

<task type="auto">
  <name>Task 2: Update remove tests for new output</name>
  <files>cmd/grove/commands/remove_test.go</files>
  <action>
    Update any existing tests that assert on "Deleted worktree" to expect "Removed worktree" instead.

    If no tests exist for output messages, skip this task.
    Run `grep -n "Deleted worktree" cmd/grove/commands/remove_test.go` first.

  </action>
  <verify>
    ```bash
    make test
    ```
  </verify>
  <done>All tests pass with new output format.</done>
</task>

</tasks>

<verification>
```bash
make test
make lint
```
All tests pass, lint clean.
</verification>

<success_criteria>

- Single removal: "Removed worktree X" (not "Deleted")
- Multi removal: "Removed N worktrees" (summary, not list)
- Branch variant: includes "and branch(es)"
- Failed removals still show individual errors
- All tests pass
  </success_criteria>

<output>
After completion, create `.planning/phases/03-foundation/03-04-SUMMARY.md`
</output>
