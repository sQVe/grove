---
phase: 03-foundation
plan: 02
type: execute
wave: 2
depends_on: ['03-01']
files_modified:
    - internal/logger/logger.go
    - cmd/grove/commands/fetch.go
    - internal/workspace/workspace.go
autonomous: true

must_haves:
    truths:
        - 'Existing spinner callers use new *Spinner API'
        - 'Backward compatibility maintained (Stop() still works)'
        - 'fetch command compiles and runs'
        - 'clone operation compiles and runs'
    artifacts:
        - path: 'internal/logger/logger.go'
          provides: 'StartSpinner removed (moved to spinner.go)'
          min_lines: 100
        - path: 'cmd/grove/commands/fetch.go'
          provides: 'Uses *Spinner with defer Stop()'
          contains: 'spinner.Stop'
        - path: 'internal/workspace/workspace.go'
          provides: 'Uses *Spinner with StopWithSuccess'
          contains: 'spinner.Stop'
    key_links:
        - from: 'cmd/grove/commands/fetch.go'
          to: 'internal/logger/spinner.go'
          via: 'logger.StartSpinner returns *Spinner'
          pattern: "logger\\.StartSpinner"
        - from: 'internal/workspace/workspace.go'
          to: 'internal/logger/spinner.go'
          via: 'logger.StartSpinner returns *Spinner'
          pattern: "logger\\.StartSpinner"
---

<objective>
Migrate existing StartSpinner callers from func() to *Spinner API and remove duplicate code from logger.go.

Purpose: Completes the spinner extraction by updating all callers. After this plan, the Spinner API is the single source of progress feedback.

Output: Updated fetch.go and workspace.go using \*Spinner, cleaned logger.go without spinner implementation.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03-foundation/03-01-SUMMARY.md

@internal/logger/logger.go
@internal/logger/spinner.go
@cmd/grove/commands/fetch.go
@internal/workspace/workspace.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove StartSpinner from logger.go</name>
  <files>internal/logger/logger.go</files>
  <action>
    Delete the StartSpinner function (lines 141-178) from logger.go.

    The function has been extracted to spinner.go in plan 03-01. Keeping both would cause a redeclaration error.

    Do NOT modify isPlain() or any other functions - they're used by spinner.go.

  </action>
  <verify>`go build ./internal/logger/...` compiles without redeclaration errors</verify>
  <done>logger.go no longer contains StartSpinner; spinner.go is the sole implementation</done>
</task>

<task type="auto">
  <name>Task 2: Update fetch.go to use *Spinner</name>
  <files>cmd/grove/commands/fetch.go</files>
  <action>
    Update the spinner usage in fetch.go (around line 104):

    Before:
    ```go
    stopSpinner := logger.StartSpinner(fmt.Sprintf("Fetching %s...", remote))
    // ... fetch logic ...
    stopSpinner()
    ```

    After:
    ```go
    spinner := logger.StartSpinner(fmt.Sprintf("Fetching %s...", remote))
    // ... fetch logic ...
    spinner.Stop()
    ```

    The change is minimal: variable name from stopSpinner to spinner, method call from stopSpinner() to spinner.Stop().

    Do NOT add StopWithSuccess/StopWithError yet - that's Phase 5 work (SPIN-06).

  </action>
  <verify>`go build ./cmd/grove/...` compiles; `grove fetch --help` runs</verify>
  <done>fetch.go uses *Spinner type with spinner.Stop()</done>
</task>

<task type="auto">
  <name>Task 3: Update workspace.go to use *Spinner</name>
  <files>internal/workspace/workspace.go</files>
  <action>
    Update the spinner usage in workspace.go (around line 156):

    Before:
    ```go
    stop := logger.StartSpinner("Cloning repository...")
    // ... clone logic ...
    stop()
    ```

    After:
    ```go
    spinner := logger.StartSpinner("Cloning repository...")
    // ... clone logic ...
    spinner.Stop()
    ```

    Same pattern as fetch.go: variable rename, method call change.

    Consider using StopWithSuccess at the end of Clone() if there's a clear success path, but keep changes minimal for now.

  </action>
  <verify>`go build ./internal/workspace/...` compiles</verify>
  <done>workspace.go uses *Spinner type with spinner.Stop()</done>
</task>

</tasks>

<verification>
- `make build` succeeds
- `make test` passes (all existing tests still work)
- `make lint` passes
- Manual test: `grove fetch` shows spinner and completes (in a grove workspace)
</verification>

<success_criteria>

- Zero callers of old func() signature remain
- All callers use \*Spinner with .Stop() method
- No functional changes to fetch or clone behavior
- CI would pass if run
  </success_criteria>

<output>
After completion, create `.planning/phases/03-foundation/03-02-SUMMARY.md`
</output>
